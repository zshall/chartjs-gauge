/*!
 * chartjs-gauge.js v0.2.0
 * https://github.com/haiiaaa/chartjs-gauge/
 * (c) 2021 chartjs-gauge.js Contributors
 * Released under the MIT License
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("chart.js")):"function"==typeof define&&define.amd?define(["chart.js"],e):(t=t||self).Gauge=e(t.Chart)}(this,(function(t){"use strict";function e(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function a(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}(t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t).defaults._set("gauge",{needle:{radiusPercentage:2,widthPercentage:3.2,lengthPercentage:80,color:"rgba(0, 0, 0, 1)",capAtMaxCapacity:!1},valueLabel:{display:!0,formatter:null,color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 1)",borderRadius:5,padding:{top:5,right:5,bottom:5,left:5},bottomMarginPercentage:5},valueDescriptionLabel:{display:!1,formatter:null,useDatasetColor:!1,color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 1)",strokeWidth:0,strokeColor:"black",borderRadius:5,padding:{top:5,right:5,bottom:5,left:5},bottomMarginPercentage:5},animation:{duration:1e3,animateRotate:!0,animateScale:!1},cutoutPercentage:50,rotation:-Math.PI,circumference:Math.PI,legend:{display:!1},tooltips:{enabled:!1}});var r=t.controllers.doughnut.extend({getMaxValue:function(t){return t[t.length-1]||1},getWidth:function(t){return t.chartArea.right-t.chartArea.left},getTranslation:function(t){var e=t.chartArea,a=t.offsetX,r=t.offsetY;return{dx:(e.left+e.right)/2+a,dy:(e.top+e.bottom)/2+r}},getAngle:function(t){var e=t.chart,a=t.value,r=t.maxValue,o=e.options;return o.rotation+o.circumference*(a/r)},drawNeedle:function(t){this.chart.animating||(t=1);var e=this.chart,a=e.ctx,r=e.config,o=e.innerRadius,n=e.outerRadius,i=r.data.datasets[this.index],l=this.getMeta().previous,s=r.options.needle,c=s.radiusPercentage,u=s.widthPercentage,h=s.lengthPercentage,d=s.color,g=s.capAtMaxCapacity,f=this.getWidth(this.chart),p=c/100*f,b=u/100*f,m=h/100*(n-o)+o,v=this.getMaxValue(i.data),x=g&&v<i.value?v:i.value,y=l.maxValue,P=g&&y<l.value?y:l.value,M=this.getTranslation(this.chart),w=M.dx,O=M.dy,C=this.getAngle({chart:this.chart,value:P,maxValue:l.maxValue}),k=C+(this.getAngle({chart:this.chart,value:x,maxValue:this.getMaxValue(i.data)})-C)*t;a.save(),a.translate(w,O),a.rotate(k),a.fillStyle=d,a.beginPath(),a.ellipse(0,0,p,p,0,0,2*Math.PI),a.fill(),a.beginPath(),a.moveTo(0,b/2),a.lineTo(m,0),a.lineTo(0,-b/2),a.fill(),a.restore()},drawValueLabel:function(e){if(this.chart.config.options.valueLabel.display){var a=this.chart,r=a.ctx,o=a.config,n=o.options.defaultFontFamily,i=o.data.datasets[this.index],l=o.options.valueLabel,s=l.formatter,c=l.fontSize,u=l.color,h=l.backgroundColor,d=l.strokeWidth,g=l.strokeColor,f=l.borderRadius,p=l.padding,b=l.bottomMarginPercentage/100*this.getWidth(this.chart),m=(s||function(t){return t})(i.value).toString();r.textBaseline="middle",r.textAlign="center",c&&(r.font="".concat(c,"px ").concat(n));var v=r.measureText(m).width,x=Math.max(r.measureText("m").width,r.measureText("Ｗ").width),y=-(p.left+v/2),P=-(p.top+x/2),M=p.left+v+p.right,w=p.top+x+p.bottom,O=this.getTranslation(this.chart),C=O.dx,k=O.dy,T=this.chart.options.rotation%(2*Math.PI);C+=b*Math.cos(T+Math.PI/2),k+=b*Math.sin(T+Math.PI/2),r.save(),r.translate(C,k),r.beginPath(),t.helpers.canvas.roundedRect(r,y,P,M,w,f),r.fillStyle=h,r.fill(),r.fillStyle=u||o.options.defaultFontColor;d&&g&&(r.lineWidth=d,r.strokeStyle=g,r.strokeText(m,0,.075*x)),r.fillText(m,0,.075*x),r.restore()}},drawValueDescriptionLabel:function(e){if(this.chart.config.options.valueDescriptionLabel.display){var a=this.chart,r=a.ctx,o=a.config,n=o.options.defaultFontFamily,i=o.data.datasets[this.index],l=o.options.valueDescriptionLabel,s=l.formatter,c=l.fontSize,u=l.useDatasetColor,h=l.color,d=l.backgroundColor,g=l.strokeWidth,f=l.strokeColor,p=l.borderRadius,b=l.padding,m=l.bottomMarginPercentage,v=0,x=i.data.sort((function(t,e){return t-e}));if(x.length){if(i.value>=x[x.length-1])v=x.length-1;else for(var y=0;y<x.length;y++)if(i.value<x[y]){v=y;break}var P=m/100*this.getWidth(this.chart),M=(s||function(t){return t})(o.data.labels[v]).toString();r.textBaseline="middle",r.textAlign="center",c&&(r.font="".concat(c,"px ").concat(n));var w=r.measureText(M).width,O=Math.max(r.measureText("m").width,r.measureText("Ｗ").width),C=-(b.left+w/2),k=-(b.top+O/2),T=b.left+w+b.right,j=b.top+O+b.bottom,V=this.getTranslation(this.chart),D=V.dx,S=V.dy,A=this.chart.options.rotation%(2*Math.PI);D+=P*Math.cos(A+Math.PI/2),S+=P*Math.sin(A+Math.PI/2),r.save(),r.translate(D,S),r.beginPath(),t.helpers.canvas.roundedRect(r,C,k,T,j,p),r.fillStyle=d,r.fill(),r.fillStyle=u?i.backgroundColor[v]:h||o.options.defaultFontColor;g&&f&&(r.lineWidth=g,r.strokeStyle=f,r.strokeText(M,0,.075*O)),r.fillText(M,0,.075*O),r.restore()}}},update:function(e){var a=this.chart.config.data.datasets[this.index],r=this.getMeta(),o={value:0,maxValue:1};e?(r.previous=null,r.current=o):(a.data.sort((function(t,e){return t-e})),r.previous=r.current||o,r.current={value:a.value,maxValue:this.getMaxValue(a.data)}),t.controllers.doughnut.prototype.update.call(this,e)},updateElement:function(r,o,n){t.controllers.doughnut.prototype.updateElement.call(this,r,o,n);var i=this.getDataset().data,l=this.chart.config.options,s=this.getMaxValue(i),c=i[o-1]||0,u=i[o],h=l.rotation+l.circumference*(c/s),d=h+l.circumference*((u-c)/s),g=d-h;r._model=function(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?a(Object(o),!0).forEach((function(a){e(t,a,o[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}({},r._model,{startAngle:h,endAngle:d,circumference:g})},draw:function(e){t.controllers.doughnut.prototype.draw.call(this,e),this.drawNeedle(e),this.drawValueLabel(e),this.drawValueDescriptionLabel(e)}});return void 0===CanvasRenderingContext2D.prototype.ellipse&&(CanvasRenderingContext2D.prototype.ellipse=function(t,e,a,r,o,n,i,l){this.save(),this.translate(t,e),this.rotate(o),this.scale(a,r),this.arc(0,0,1,n,i,l),this.restore()}),t.controllers.gauge=r,t.Gauge=function(e,a){return a.type="gauge",new t(e,a)},t.Gauge}));
